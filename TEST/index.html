<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Radio Malaysia - Strim Langsung Premium</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* TEMA DARK MODE PREMIUM - HITAM & PUTIH */
    :root {
      --primary: #ffffff;
      --secondary: #cccccc;
      --dark: #000000;
      --light: #1a1a1a;
      --bg: #000000;
      --text: #ffffff;
      --card-bg: rgba(17, 17, 17, 0.7);
      --card-border: rgba(255, 255, 255, 0.1);
      --header-text: #ffffff;
      --favorite: #ff3366;
      --accent: #ffffff;
      --shadow: rgba(255, 255, 255, 0.1);
      --search-bg: rgba(10, 10, 10, 0.8);
      --gradient-primary: linear-gradient(135deg, #000000, #1a1a1a);
      --gradient-secondary: linear-gradient(135deg, #111111, #222222);
      --timer-active: #00ff00;
      --timer-warning: #ffff00;
      --timer-danger: #ff0000;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      min-height: 100vh;
      color: var(--text);
      padding: 20px;
      overflow-x: hidden;
      position: relative;
    }
    
    /* Parallax Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.02) 0%, transparent 50%),
        linear-gradient(45deg, #000000 0%, #0a0a0a 100%);
      z-index: -2;
      animation: parallaxBg 20s ease-in-out infinite alternate;
    }
    
    @keyframes parallaxBg {
      0% { 
        transform: translate(0, 0) scale(1);
        background-position: 0% 0%;
      }
      100% { 
        transform: translate(-50px, 50px) scale(1.1);
        background-position: 100% 100%;
      }
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.85);
      border-radius: 25px;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      overflow: hidden;
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      transform-style: preserve-3d;
      perspective: 1000px;
    }
    
    /* Animated Background Lines */
    .container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: 
        repeating-linear-gradient(
          45deg,
          transparent,
          transparent 10px,
          rgba(255, 255, 255, 0.02) 10px,
          rgba(255, 255, 255, 0.02) 20px
        );
      z-index: -1;
      animation: slideLines 30s linear infinite;
    }
    
    @keyframes slideLines {
      0% { transform: rotate(0deg) translateY(0); }
      100% { transform: rotate(360deg) translateY(100px); }
    }
    
    /* HEADER PREMIUM */
    .header {
      background: linear-gradient(
        135deg, 
        #000000 0%, 
        #111111 25%, 
        #222222 50%, 
        #111111 75%, 
        #000000 100%
      );
      background-size: 400% 400%;
      color: var(--header-text);
      padding: 40px 30px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
      animation: gradientFlow 15s ease infinite;
    }
    
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, 
        transparent, 
        var(--primary), 
        #ff3366,
        var(--primary), 
        transparent
      );
      animation: shine 3s linear infinite;
    }
    
    @keyframes shine {
      0% { background-position: -200px 0; }
      100% { background-position: calc(200px + 100%) 0; }
    }
    
    .header h1 {
      font-size: 2.8rem;
      font-weight: 800;
      margin-bottom: 10px;
      background: linear-gradient(45deg, #ffffff, #cccccc, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 2px 10px rgba(255, 255, 255, 0.1);
      position: relative;
      display: inline-block;
      letter-spacing: 1px;
    }
    
    .header h1::after {
      content: 'üìª';
      position: absolute;
      right: -45px;
      top: 50%;
      transform: translateY(-50%);
      animation: radioWave 2s infinite;
      font-size: 1.8rem;
      filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
    }
    
    @keyframes radioWave {
      0%, 100% { 
        opacity: 0.5; 
        transform: translateY(-50%) scale(1);
        filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.3));
      }
      50% { 
        opacity: 1; 
        transform: translateY(-50%) scale(1.2);
        filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.8));
      }
    }
    
    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
      color: var(--secondary);
      margin-top: 10px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }
    
    .tagline {
      display: inline-block;
      background: rgba(255, 255, 255, 0.1);
      padding: 8px 20px;
      border-radius: 50px;
      margin-top: 15px;
      font-size: 0.9rem;
      font-weight: 500;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      animation: float 6s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    
    /* PLAYER SECTION PREMIUM */
    .player-section {
      padding: 30px;
      background: var(--light);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
    }
    
    .player-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.1), 
        transparent
      );
    }
    
    .player-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 25px;
      padding: 25px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 20px;
      margin-bottom: 20px;
      box-shadow: 
        inset 5px 5px 10px rgba(0, 0, 0, 0.5),
        inset -5px -5px 10px rgba(255, 255, 255, 0.05),
        0 10px 30px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    /* PLAY BUTTON PREMIUM */
    .play-btn {
      background: linear-gradient(145deg, #000000, #1a1a1a);
      border: none;
      padding: 20px 40px;
      border-radius: 50px;
      color: var(--text);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      overflow: hidden;
      box-shadow: 
        8px 8px 16px rgba(0, 0, 0, 0.8),
        -8px -8px 16px rgba(255, 255, 255, 0.05),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      font-size: 1.1rem;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 180px;
      justify-content: center;
    }
    
    .play-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent
      );
      transition: left 0.7s;
    }
    
    .play-btn:hover::before {
      left: 100%;
    }
    
    .play-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 
        12px 12px 24px rgba(0, 0, 0, 0.9),
        -12px -12px 24px rgba(255, 255, 255, 0.1),
        0 0 20px rgba(255, 255, 255, 0.1);
    }
    
    .play-btn:active {
      transform: translateY(0) scale(0.98);
      box-shadow: 
        inset 6px 6px 12px rgba(0, 0, 0, 0.8),
        inset -6px -6px 12px rgba(255, 255, 255, 0.05);
    }
    
    /* Pulsing effect for playing state */
    .play-btn.playing::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      transform: translate(-50%, -50%);
      animation: pulseRing 2s infinite;
      border-radius: 50%;
      z-index: 0;
    }
    
    @keyframes pulseRing {
      0% { 
        width: 100%; 
        height: 100%; 
        opacity: 0.7; 
      }
      100% { 
        width: 150%; 
        height: 150%; 
        opacity: 0; 
      }
    }
    
    .play-btn i {
      font-size: 1.3rem;
      position: relative;
      z-index: 1;
    }
    
    .play-btn span {
      position: relative;
      z-index: 1;
    }
    
    /* CURRENT STATION PREMIUM */
    .current-station {
      background: rgba(17, 17, 17, 0.8);
      border: 2px solid rgba(255, 255, 255, 0.1);
      padding: 15px 25px;
      border-radius: 50px;
      font-weight: 600;
      color: var(--text);
      min-width: 250px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }
    
    .current-station::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.05),
        transparent
      );
      transition: left 0.7s;
    }
    
    .current-station.playing::before {
      left: 100%;
    }
    
    .current-station.playing {
      border-color: var(--primary);
      color: var(--primary);
      box-shadow: 
        0 0 20px rgba(255, 255, 255, 0.1),
        inset 0 0 10px rgba(255, 255, 255, 0.05);
    }
    
    /* VISUALIZER PREMIUM */
    .advanced-visualizer {
      display: flex;
      align-items: center;
      height: 25px;
      gap: 2px;
      margin-left: 10px;
    }
    
    .advanced-bar {
      width: 3px;
      background: linear-gradient(to top, var(--primary), #ff3366);
      border-radius: 2px 2px 0 0;
      animation: barPulse 1.5s infinite ease-in-out;
      transform-origin: bottom;
    }
    
    @keyframes barPulse {
      0%, 100% { 
        transform: scaleY(0.3); 
        opacity: 0.7; 
      }
      50% { 
        transform: scaleY(1); 
        opacity: 1; 
      }
    }
    
    /* VOLUME CONTROL PREMIUM */
    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(17, 17, 17, 0.8);
      padding: 10px 20px;
      border-radius: 50px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }
    
    .volume-slider {
      width: 120px;
      height: 6px;
      background: linear-gradient(to right, var(--primary) 70%, var(--card-border) 70%);
      border-radius: 3px;
      outline: none;
      -webkit-appearance: none;
      cursor: pointer;
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
    }
    
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: var(--primary);
      border-radius: 50%;
      cursor: pointer;
      border: 3px solid var(--dark);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
      transition: all 0.3s;
    }
    
    .volume-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }
    
    /* ADDITIONAL CONTROLS */
    .additional-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    
    .control-btn {
      background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(26, 26, 26, 0.8));
      border: 2px solid rgba(255, 255, 255, 0.1);
      color: var(--text);
      padding: 12px 25px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      display: flex;
      align-items: center;
      gap: 10px;
      backdrop-filter: blur(10px);
      box-shadow: 
        5px 5px 15px rgba(0, 0, 0, 0.5),
        -5px -5px 15px rgba(255, 255, 255, 0.05);
    }
    
    .control-btn:hover {
      border-color: var(--primary);
      transform: translateY(-3px);
      box-shadow: 
        8px 8px 20px rgba(0, 0, 0, 0.6),
        -8px -8px 20px rgba(255, 255, 255, 0.1),
        0 0 15px rgba(255, 255, 255, 0.1);
    }
    
    .control-btn.active {
      background: var(--primary);
      color: var(--dark);
      border-color: var(--primary);
      box-shadow: 
        0 0 20px rgba(255, 255, 255, 0.3),
        inset 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    
    /* SLEEP TIMER PREMIUM */
    .sleep-timer-container {
      position: relative;
    }
    
    .sleep-timer-dropdown {
      position: absolute;
      top: calc(100% + 10px);
      left: 50%;
      transform: translateX(-50%) translateY(-20px);
      background: rgba(0, 0, 0, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 25px;
      width: 320px;
      z-index: 100;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      display: none;
      backdrop-filter: blur(20px);
      opacity: 0;
      transform-origin: top center;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      pointer-events: none;
    }
    
    .sleep-timer-dropdown.active {
      display: block;
      opacity: 1;
      transform: translateX(-50%) translateY(0);
      pointer-events: auto;
    }
    
    .timer-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .timer-option {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      color: var(--text);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    
    .timer-option:hover {
      background: var(--primary);
      color: var(--dark);
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
    }
    
    .timer-option.active {
      background: var(--primary);
      color: var(--dark);
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    }
    
    /* NOW PLAYING BAR */
    .now-playing-bar {
      background: rgba(17, 17, 17, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 30px 0;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 
        inset 0 2px 10px rgba(0, 0, 0, 0.5),
        0 5px 20px rgba(0, 0, 0, 0.3);
    }
    
    .now-playing-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .song-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 60%;
    }
    
    .station-info {
      font-size: 1rem;
      color: var(--secondary);
      opacity: 0.8;
      font-weight: 500;
    }
    
    .progress-bar {
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      position: relative;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), #ff3366);
      border-radius: 3px;
      width: 30%;
      position: relative;
      animation: progressPulse 2s infinite;
    }
    
    @keyframes progressPulse {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }
    
    .progress-time {
      position: absolute;
      right: 0;
      top: -25px;
      font-size: 0.9rem;
      color: var(--secondary);
      font-weight: 500;
    }
    
    /* TABS PREMIUM */
    .tabs-container {
      position: relative;
      padding: 0 30px;
      margin: 20px 0;
    }
    
    .tabs {
      display: flex;
      justify-content: center;
      gap: 5px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50px;
      padding: 5px;
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 
        inset 0 2px 10px rgba(0, 0, 0, 0.5),
        0 5px 20px rgba(0, 0, 0, 0.3);
    }
    
    .tab-slider {
      position: absolute;
      top: 5px;
      left: 5px;
      height: calc(100% - 10px);
      background: linear-gradient(90deg, var(--primary), #ff3366);
      border-radius: 50px;
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      box-shadow: 0 2px 10px rgba(255, 255, 255, 0.2);
      z-index: 1;
    }
    
    .tab {
      position: relative;
      z-index: 2;
      padding: 15px 35px;
      background: transparent;
      border: none;
      color: var(--secondary);
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s;
      border-radius: 50px;
      font-size: 1rem;
      letter-spacing: 0.5px;
    }
    
    .tab.active {
      color: var(--dark);
      font-weight: 700;
    }
    
    /* SEARCH SECTION */
    .search-section {
      padding: 0 30px 20px;
      position: relative;
    }
    
    .search-container {
      position: relative;
      width: 100%;
    }
    
    .search-input {
      width: 100%;
      padding: 18px 20px 18px 55px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      font-size: 1.1rem;
      outline: none;
      transition: all 0.4s;
      background: rgba(10, 10, 10, 0.8);
      color: var(--text);
      box-shadow: 
        inset 0 5px 15px rgba(0, 0, 0, 0.5),
        0 5px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .search-input::placeholder {
      color: #666666;
      font-weight: 400;
    }
    
    .search-input:focus {
      border-color: var(--primary);
      box-shadow: 
        0 0 0 3px rgba(255, 255, 255, 0.1),
        inset 0 5px 15px rgba(0, 0, 0, 0.5),
        0 10px 30px rgba(0, 0, 0, 0.5);
      transform: translateY(-2px);
    }
    
    .search-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--secondary);
      font-size: 1.3rem;
      transition: color 0.3s;
    }
    
    .search-input:focus + .search-icon {
      color: var(--primary);
      animation: searchPulse 1s infinite;
    }
    
    @keyframes searchPulse {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.1); }
    }
    
    /* STATIONS GRID PREMIUM */
    .stations-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      padding: 30px;
      background: transparent;
      min-height: 400px;
    }
    
    /* STATION CARD PREMIUM */
    .station-card {
      background: rgba(17, 17, 17, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 25px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-weight: 600;
      color: var(--text);
      position: relative;
      overflow: hidden;
      transform-style: preserve-3d;
      perspective: 1000px;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 140px;
    }
    
    .station-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent
      );
      transition: left 0.7s;
    }
    
    .station-card:hover::before {
      left: 100%;
    }
    
    .station-card:hover {
      transform: translateY(-10px) rotateX(5deg);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.7),
        0 10px 20px rgba(255, 255, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      border-color: var(--primary);
    }
    
    .station-card.active {
      background: rgba(255, 255, 255, 0.95);
      color: #000000;
      border-color: var(--primary);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.7),
        0 0 30px rgba(255, 255, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      transform: translateY(-5px);
    }
    
    /* Add radio frequency effect to active cards */
    .station-card.active::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, 
        transparent, 
        rgba(255, 255, 255, 0.3), 
        transparent
      );
      z-index: -1;
      border-radius: 22px;
      animation: frequencyGlow 2s linear infinite;
    }
    
    @keyframes frequencyGlow {
      0% { opacity: 0.3; }
      50% { opacity: 0.7; }
      100% { opacity: 0.3; }
    }
    
    .category-badge {
      position: absolute;
      top: 12px;
      left: 12px;
      background: rgba(255, 51, 102, 0.9);
      color: white;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.75rem;
      font-weight: 600;
      backdrop-filter: blur(5px);
      box-shadow: 0 5px 15px rgba(255, 51, 102, 0.3);
      z-index: 2;
    }
    
    .favorite-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: #666666;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 10;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      backdrop-filter: blur(5px);
    }
    
    .favorite-btn:hover {
      color: var(--favorite);
      transform: scale(1.2) rotate(15deg);
      background: rgba(255, 255, 255, 0.2);
      box-shadow: 0 5px 15px rgba(255, 51, 102, 0.3);
    }
    
    .favorite-btn.active {
      color: var(--favorite);
      background: rgba(255, 255, 255, 0.2);
      animation: heartBeat 1s ease;
    }
    
    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }
    
    .station-icon {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--primary);
      opacity: 0.9;
      filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.3));
    }
    
    .station-name {
      font-size: 1.1rem;
      font-weight: 600;
      line-height: 1.4;
    }
    
    /* LOADING PREMIUM */
    .loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 30px 50px;
      border-radius: 25px;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      z-index: 2000;
      display: none;
      color: var(--text);
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      text-align: center;
      min-width: 200px;
    }
    
    .loading::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, 
        #ffffff, 
        #cccccc, 
        #ffffff, 
        #cccccc
      );
      background-size: 400% 400%;
      z-index: -1;
      border-radius: 27px;
      animation: loadingBorder 2s linear infinite;
      filter: blur(5px);
    }
    
    @keyframes loadingBorder {
      0% { background-position: 0% 50%; }
      100% { background-position: 400% 50%; }
    }
    
    .loading i {
      animation: spinWithBounce 1.5s infinite cubic-bezier(0.68, -0.55, 0.265, 1.55);
      margin-right: 15px;
      font-size: 1.5rem;
    }
    
    @keyframes spinWithBounce {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(180deg) scale(1.2); }
      100% { transform: rotate(360deg) scale(1); }
    }
    
    .loading span {
      font-weight: 600;
      letter-spacing: 1px;
      background: linear-gradient(45deg, #ffffff, #cccccc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* ERROR MESSAGE */
    .error-message {
      background: rgba(51, 0, 0, 0.9);
      color: #ff6666;
      padding: 15px 20px;
      border-radius: 12px;
      margin-top: 20px;
      display: none;
      font-size: 0.95rem;
      border: 1px solid #660000;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(255, 0, 0, 0.2);
    }
    
    /* NOTIFICATION PREMIUM */
    .notification {
      position: fixed;
      top: 30px;
      right: 30px;
      background: rgba(0, 0, 0, 0.95);
      color: var(--text);
      padding: 20px 25px;
      border-radius: 15px;
      box-shadow: 
        0 10px 40px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      z-index: 1000;
      animation: slideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      max-width: 350px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-family: 'Poppins', sans-serif;
      backdrop-filter: blur(20px);
      transform-origin: top right;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .notification i {
      font-size: 1.5rem;
      color: var(--primary);
    }
    
    .notification.success i {
      color: #00ff00;
    }
    
    .notification.error i {
      color: #ff3366;
    }
    
    @keyframes slideIn {
      from { 
        transform: translateX(100%) scale(0.8); 
        opacity: 0; 
      }
      to { 
        transform: translateX(0) scale(1); 
        opacity: 1; 
      }
    }
    
    @keyframes slideOut {
      from { 
        transform: translateX(0) scale(1); 
        opacity: 1; 
      }
      to { 
        transform: translateX(100%) scale(0.8); 
        opacity: 0; 
      }
    }
    
    /* WAVEFORM BACKGROUND CANVAS */
    #waveformBg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      opacity: 0.2;
    }
    
    /* RESPONSIVE DESIGN */
    @media (max-width: 992px) {
      .stations-grid {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      }
      
      .header h1 {
        font-size: 2.3rem;
      }
      
      .player-controls {
        flex-wrap: wrap;
        gap: 20px;
      }
    }
    
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .header h1::after {
        right: -35px;
        font-size: 1.5rem;
      }
      
      .stations-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        padding: 20px;
      }
      
      .player-controls {
        flex-direction: column;
      }
      
      .current-station {
        width: 100%;
        min-width: auto;
      }
      
      .additional-controls {
        flex-direction: column;
        align-items: center;
      }
      
      .control-btn {
        width: 100%;
        max-width: 250px;
        justify-content: center;
      }
      
      .sleep-timer-dropdown {
        width: 280px;
      }
      
      .now-playing-info {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .song-title {
        max-width: 100%;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .container {
        border-radius: 20px;
      }
      
      .header {
        padding: 25px 20px;
      }
      
      .header h1 {
        font-size: 1.8rem;
      }
      
      .header h1::after {
        display: none;
      }
      
      .header p {
        font-size: 1rem;
      }
      
      .player-section {
        padding: 20px;
      }
      
      .play-btn {
        padding: 16px 30px;
        min-width: 160px;
        font-size: 1rem;
      }
      
      .stations-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        padding: 15px;
      }
      
      .station-card {
        height: 130px;
        padding: 20px 15px;
      }
      
      .station-icon {
        font-size: 2rem;
      }
      
      .station-name {
        font-size: 1rem;
      }
      
      .now-playing-bar {
        margin: 15px;
        padding: 15px;
      }
      
      .tab {
        padding: 12px 20px;
        font-size: 0.9rem;
      }
    }
    
    /* ANIMATION FOR ALL ELEMENTS */
    * {
      transition: 
        background-color 0.4s ease,
        border-color 0.4s ease,
        color 0.4s ease,
        transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
        opacity 0.4s ease,
        box-shadow 0.4s ease;
    }
    
    /* ACCESSIBILITY */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* SCROLLBAR STYLING */
    ::-webkit-scrollbar {
      width: 10px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(to bottom, var(--primary), #666666);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(to bottom, var(--primary), #ff3366);
    }
    
    /* CUSTOM TIMER INPUT */
    .custom-timer-input {
      grid-column: span 2;
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    
    .custom-timer-input::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.05),
        transparent
      );
      transition: left 0.7s;
    }
    
    .custom-timer-input:hover::before {
      left: 100%;
    }
    
    .custom-timer-input h4 {
      color: var(--primary);
      font-size: 1rem;
      margin-bottom: 5px;
      text-align: center;
      position: relative;
      z-index: 1;
      font-weight: 600;
    }
    
    .custom-time-controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 1;
    }
    
    .time-controls {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }
    
    .custom-time-input {
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid rgba(255, 255, 255, 0.1);
      color: var(--text);
      padding: 12px;
      border-radius: 10px;
      width: 80px;
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
      transition: all 0.3s;
      position: relative;
      z-index: 1;
      backdrop-filter: blur(5px);
    }
    
    .custom-time-input:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
      transform: scale(1.05);
    }
    
    .time-unit {
      color: var(--secondary);
      font-size: 0.9rem;
      margin-left: 5px;
      position: relative;
      z-index: 1;
      font-weight: 500;
    }
    
    .time-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--text);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(5px);
    }
    
    .time-btn:hover {
      background: var(--primary);
      color: var(--dark);
      transform: scale(1.1);
      box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
    }
    
    .set-custom-timer {
      background: linear-gradient(90deg, var(--primary), #ff3366);
      color: var(--dark);
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s;
      margin-top: 5px;
      position: relative;
      z-index: 1;
      overflow: hidden;
      letter-spacing: 1px;
    }
    
    .set-custom-timer:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 51, 102, 0.4);
    }
  </style>
</head>
<body>
  <!-- Canvas for animated waveform background -->
  <canvas id="waveformBg"></canvas>
  
  <div class="container">
    <div class="header">
      <h1><i class="fas fa-radio" style="margin-right: 15px;"></i>Radio Malaysia</h1>
      <p>Strim Langsung Premium - Pengalaman Mendengar Radio Terbaik di Malaysia</p>
      <div class="tagline">üéß 80+ Stesen | üì∂ Live Streaming | ‚≠ê Kegemaran</div>
    </div>

    <div class="player-section">
      <div class="player-controls">
        <button class="play-btn" id="playBtn">
          <span id="playIcon"><i class="fas fa-play"></i></span>
          <span id="btnText">Main</span>
        </button>
        
        <div class="current-station" id="currentStation">
          <span id="stationName">Pilih Stesen Radio</span>
          <div class="advanced-visualizer" id="visualizer">
            <!-- Visualizer bars will be added by JavaScript -->
          </div>
        </div>
        
        <div class="volume-control">
          <span id="volumeIcon"><i class="fas fa-volume-up"></i></span>
          <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="0.7">
        </div>
      </div>
      
      <!-- Now Playing Bar -->
      <div class="now-playing-bar">
        <div class="now-playing-info">
          <div class="song-title" id="songTitle">Radio Malaysia - Strim Langsung</div>
          <div class="station-info" id="stationInfo">Tiada stesen aktif</div>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
          <div class="progress-time" id="progressTime">LIVE</div>
        </div>
      </div>
      
      <div class="additional-controls">
        <div class="sleep-timer-container">
          <button class="control-btn" id="sleepTimerBtn">
            <i class="fas fa-bed"></i>
            <span id="sleepTimerText">Pemasa Tidur</span>
          </button>
          <div class="sleep-timer-dropdown" id="sleepTimerDropdown">
            <div class="timer-options">
              <div class="timer-option" data-minutes="15">15 Minit</div>
              <div class="timer-option" data-minutes="30">30 Minit</div>
              <div class="timer-option" data-minutes="45">45 Minit</div>
              <div class="timer-option" data-minutes="60">1 Jam</div>
              <div class="timer-option" data-minutes="90">1.5 Jam</div>
              <div class="timer-option" data-minutes="120">2 Jam</div>
              <div class="custom-timer-input">
                <h4>Masa Custom</h4>
                <div class="custom-time-controls">
                  <div class="time-controls">
                    <button class="time-btn" id="decreaseMinutes"><i class="fas fa-minus"></i></button>
                    <input type="number" class="custom-time-input" id="customMinutes" min="1" max="300" value="30">
                    <span class="time-unit">minit</span>
                    <button class="time-btn" id="increaseMinutes"><i class="fas fa-plus"></i></button>
                  </div>
                </div>
                <button class="set-custom-timer" id="setCustomTimer">Set Masa</button>
              </div>
              <div class="timer-option" id="cancelTimer">Batal Pemasa</div>
            </div>
            <div class="timer-display" id="timerDisplay"></div>
          </div>
        </div>
        
        <button class="control-btn" id="favoritesBtn">
          <i class="fas fa-heart"></i>
          <span id="favoritesText">Kegemaran</span>
        </button>
      </div>
      
      <div class="error-message" id="errorMessage"></div>
    </div>

    <!-- Tabs with animated slider -->
    <div class="tabs-container">
      <div class="tabs">
        <div class="tab-slider" id="tabSlider"></div>
        <button class="tab active" id="allStationsTab">Semua Stesen</button>
        <button class="tab" id="favoritesTab">Kegemaran</button>
        <button class="tab" id="popularTab">Popular</button>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-section">
      <div class="search-container">
        <input type="text" class="search-input" id="searchInput" placeholder="Cari stesen radio...">
        <div class="search-icon">
          <i class="fas fa-search"></i>
        </div>
      </div>
    </div>

    <!-- Stations Grid -->
    <div class="stations-grid" id="stationsGrid">
      <!-- Stations will be loaded by JavaScript -->
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading" id="loading">
    <i class="fas fa-spinner"></i>
    <span>Memuatkan...</span>
  </div>
  
  <!-- Audio Player -->
  <audio id="audioPlayer" style="display: none;"></audio>

  <script>
    const stations = [
      { name: 'Johor FM', url: 'https://22273.live.streamtheworld.com:443/JOHOR_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-tower-broadcast' },
      { name: 'Era', url: 'https://n13.rcs.revma.com/crec9cmbv4uvv/13_b3tkiac680b302/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-music' },
      { name: 'Era FM Sarawak', url: 'https://stream-eu-a.rcs.revma.com/bkqfqkrbv4uvv/68_p7vhxushjqmj02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-music' },
      { name: 'Era FM Sabah', url: 'https://stream-eu-a.rcs.revma.com/4p3nqmmbv4uvv/18_1oxzafird6r4w02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-music' },
      { name: 'Hot FM', url: 'https://n09.rcs.revma.com/drakdf8mtd3vv/9_15wt5oojtyqo002/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-fire' },
      { name: 'Sinar', url: 'https://n01.rcs.revma.com/azatk0tbv4uvv/1_11a5yc3kn9ion02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-sun' },
      { name: 'Gegar', url: 'https://n04.rcs.revma.com/cn0zcqsbv4uvv/4_1l8b0uuius0ad02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-drum' },
      { name: 'Suria FM', url: 'https://28163.live.streamtheworld.com:443/SURIA_FM.mp3', type: 'mp3', category: 'Hiburan', icon: 'fas fa-sun' },
      { name: 'Asyik FM', url: 'https://22273.live.streamtheworld.com:443/ASYIK_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-heart' },
      { name: 'Zayan', url: 'https://n40a-eu.rcs.revma.com/7ww2a4tbv4uvv/64_2yvaj6nnb69x02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-headphones' },
      { name: 'Ikim FM', url: 'https://ais-sa8.cdnstream1.com/5035', type: 'mp3', category: 'Agama', icon: 'fas fa-mosque' },
      { name: 'Hitz FM', url: 'https://n14.rcs.revma.com/488kt4sbv4uvv/14_u3tcp2wu9q1l02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-bolt' },
      { name: 'Fly FM', url: 'https://n16.rcs.revma.com/q17aka9mtd3vv/16_bsg38prd9vlj02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-plane' },
      { name: 'Mix FM', url: 'https://n06.rcs.revma.com/v5pq3htbv4uvv/6_18aiu7hejxpf402/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-sliders-h' },
      { name: 'Lite FM', url: 'https://stream.rcs.revma.com/2483gbtbv4uvv/hls.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-volume-down' },
      { name: 'My FM', url: 'https://n08.rcs.revma.com/hc3unrtbv4uvv/8_1xcfbljp5h4kh02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-user' },
      { name: 'Eight FM', url: 'https://n08.rcs.revma.com/qp0xrd9mtd3vv/8_18nbo6343bsv702/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-8' },
      { name: '988 FM', url: 'https://22243.live.streamtheworld.com:443/988_FM.mp3', type: 'mp3', category: 'Hiburan', icon: 'fas fa-broadcast-tower' },
      { name: 'Ai FM', url: 'https://22283.live.streamtheworld.com:443/AI_FMAAC_SC', type: 'aac', category: 'Maklumat', icon: 'fas fa-info-circle' },
      { name: 'Melody FM', url: 'https://n05.rcs.revma.com/2u1n6dtbv4uvv/5_bl5fx9vxqa7002/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-music' },
      { name: 'Raaga FM', url: 'https://n06.rcs.revma.com/1ut6qwtbv4uvv/6_1grktyf0p5qpr02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-guitar' },
      { name: 'Minnal FM', url: 'https://22283.live.streamtheworld.com:443/MINNAL_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-bolt' },
      { name: 'Best FM', url: 'https://n16.rcs.revma.com/h34x4kgg9hhvv/16_uf5os5tk9j3302/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-star' },
      { name: 'Kool 101', url: 'https://n08.rcs.revma.com/3930238mtd3vv/8_2whawsg3fhmw02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-snowflake' },
      { name: 'Traxx FM', url: 'https://28103.live.streamtheworld.com:443/TRAXX_FMAAC_SC', type: 'aac', category: 'Muzik', icon: 'fas fa-road' },
      { name: 'Manis FM', url: 'https://n04.rcs.revma.com/nzgauqq1v7zuv?rj-ttl=5&rj-tok=AAABk0iQHXoAHiTOyor8YOoWlA', type: 'mp3', category: 'Hiburan', icon: 'fas fa-candy-cane' },
      { name: 'Molek FM', url: 'https://n09.rcs.revma.com/z56xa78mtd3vv/9_13apqo12zyyxc02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-gem' },
      { name: 'Klasik FM', url: 'https://28163.live.streamtheworld.com:443/RADIO_KLASIKAAC.aac', type: 'aac', category: 'Muzik', icon: 'fas fa-landmark' },
      { name: 'Nasional FM', url: 'https://22253.live.streamtheworld.com:443/NASIONAL_FMAAC_SC', type: 'aac', category: 'Maklumat', icon: 'fas fa-flag' },
      { name: 'Kelantan FM', url: 'https://22253.live.streamtheworld.com/KELANTAN_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Terengganu FM', url: 'https://22243.live.streamtheworld.com:443/TERENGGANU_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Pahang FM', url: 'https://22253.live.streamtheworld.com:443/PAHANG_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Kedah FM', url: 'https://22283.live.streamtheworld.com:443/KEDAH_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Perak FM', url: 'https://22253.live.streamtheworld.com:443/PERAK_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'KL FM', url: 'https://22273.live.streamtheworld.com:443/KL_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-city' },
      { name: 'Selangor FM', url: 'https://22273.live.streamtheworld.com:443/SELANGOR_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Negeri FM', url: 'https://28103.live.streamtheworld.com:443/NEGERI_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Melaka FM', url: 'https://28163.live.streamtheworld.com:443/MELAKA_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Sabah FM', url: 'https://22253.live.streamtheworld.com:443/SABAH_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Sabav FM', url: 'https://live.mana2.my/SabahvFm/index.m3u8?auth_key=1751709243-dbcc404ffb8f47d09ac2e63e4f50b57a-0-974d5941d84f8b15e1141c53c1b11aff', type: 'm3u8', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Sarawak FM', url: 'https://22273.live.streamtheworld.com:443/SARAWAK_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'BFM', url: 'https://22273.live.streamtheworld.com:443/BFMAAC.aac', type: 'aac', category: 'Maklumat', icon: 'fas fa-briefcase' },
      { name: 'Awani FM', url: 'https://d2idp3hzkhjpih.cloudfront.net/out/v1/4b85d9c2bf97413eb0c9fd875599b837/index_3.m3u8', type: 'm3u8', category: 'Berita', icon: 'fas fa-newspaper' },
      { name: 'Wai FM Iban', url: 'https://28093.live.streamtheworld.com:443/WAI_FM_IBANAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-language' },
      { name: 'GoXuan', url: 'https://n07a-eu.rcs.revma.com/xt9nhzsbv4uvv/7_1kpxic2j08fx102/playlist.m3u8?rj-ttl=5&rj-tok=AAABk0ivpMMAofdsXSo_Xm0zMQ', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-play-circle' },
      { name: 'Sinar FM Rock Kapak', url: 'https://n26a-eu.rcs.revma.com/rz43weh811uvv/38_lwj92qdqradk02/main/173487890.aac', type: 'aac', category: 'Muzik', icon: 'fas fa-guitar' },
      { name: 'Cats FM', url: 'https://s4.yesstreaming.net:7019/stream/1/', type: 'mp3', category: 'Hiburan', icon: 'fas fa-cat' },
      { name: 'Bapakku FM', url: 'https://servidor30-2.brlogic.com:7048/live', type: 'mp3', category: 'Hiburan', icon: 'fas fa-user-friends' },
      { name: 'Mutiara FM', url: 'https://22243.live.streamtheworld.com/MUTIARA_FMAAC_SC', type: 'aac', category: 'Hiburan', icon: 'fas fa-gem' },
      { name: 'Bernama Radio', url: 'https://live.mana2.my/BernamaRadio/index.m3u8?auth_key=1751701131-4651f03a95c347a98d018eeb31d1a8c3-0-d6865f5c9af42ffbfbc04475ecb3266d', type: 'm3u8', category: 'Berita', icon: 'fas fa-newspaper' },
      { name: 'Radio Sandakan', url: 'https://28163.live.streamtheworld.com/SANDAKAN_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Perlis FM', url: 'https://22243.live.streamtheworld.com/PERLIS_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Kupi Kupi FM', url: 'https://n05.rcs.revma.com/axht8yawe1bwv?rj-ttl=5&rj-tok=AAABl9iJ47QAYuY0lBhb6a0OXw', type: 'mp3', category: 'Hiburan', icon: 'fas fa-coffee' },
      { name: 'Jei FM', url: 'https://usa3.fastcast4u.com/proxy/jeifm?mp=/stream/1/', type: 'mp3', category: 'Hiburan', icon: 'fas fa-microphone' },
      { name: 'Radio Amboi FM', url: 'https://stream-173.zeno.fm/555kr7upam0uv', type: 'mp3', category: 'Hiburan', icon: 'fas fa-broadcast-tower' },
      { name: 'Labuan FM', url: 'https://28153.live.streamtheworld.com/LABUAN_FMAAC_SC', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Rakita FM', url: 'https://live.mana2.my/RakitaFm/index.m3u8?auth_key=1751702967-86d3d46da8ac471da4766fefcca8ff47-0-ef6f32e1a7cedb41178f2db21d0c705c', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-rocket' },
      { name: 'Osai FM', url: 'https://stream-eu-a.rcs.revma.com/60s783vbv4uvv/22_vi0k2u9iyuoj02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-volume-up' },
      { name: 'Oli 96.8', url: 'https://22393.live.streamtheworld.com/OLI968FMAAC.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-oil-can' },
      { name: 'Tawau FM', url: 'https://22253.live.streamtheworld.com/TAWAU_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-map-marker-alt' },
      { name: 'Kristal FM', url: 'https://play.thestreamtech.com:7038/index.html', type: 'mp3', category: 'Hiburan', icon: 'fas fa-gem' },
      { name: 'Buletin FM', url: 'https://stream.rcs.revma.com/3930238mtd3vv/hls.m3u8', type: 'm3u8', category: 'Berita', icon: 'fas fa-bullhorn' },
      { name: 'Love 972', url: 'https://28453.live.streamtheworld.com/LOVE972FM_PREM.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-heart' },
      { name: 'India Beat FM', url: 'https://stream-eu-a.rcs.revma.com/hrcdg9ubv4uvv/32_l87jk9e4xju502/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-dharmachakra' },
      { name: 'Classic Rock FM', url: 'https://stream-eu-a.rcs.revma.com/fk3507vbv4uvv/21_123cdbkwmeooj02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-guitar' },
      { name: '987 FM', url: 'https://28443.live.streamtheworld.com/987FM_PREM.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-broadcast-tower' },
      { name: 'YES 933', url: 'https://28313.live.streamtheworld.com/YES933_PREM.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-thumbs-up' },
      { name: 'Red FM', url: 'https://28163.live.streamtheworld.com/RED_FMAAC.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-circle' },
      { name: '883 FM', url: 'https://22283.live.streamtheworld.com/883JIA.mp3', type: 'mp3', category: 'Hiburan', icon: 'fas fa-broadcast-tower' },
      { name: 'Gold FM', url: 'https://stream-eu-a.rcs.revma.com/fxq2n9tbv4uvv/32_t9ako5786llk02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-medal' },
      { name: 'UFM', url: 'https://22283.live.streamtheworld.com/UFM_1003AAC.aac', type: 'aac', category: 'Hiburan', icon: 'fas fa-broadcast-tower' },
      { name: 'Kenyalang FM', url: 'https://stream-eu-a.rcs.revma.com/qyg9zmvbv4uvv/52_15nleuhxrs9mr02/playlist.m3u8', type: 'm3u8', category: 'Tempatan', icon: 'fas fa-dove' },
      { name: 'Langkawi FM', url: 'https://28103.live.streamtheworld.com/LANGKAWI_FMAAC.aac', type: 'aac', category: 'Tempatan', icon: 'fas fa-umbrella-beach' },
      { name: 'Bayu FM', url: 'https://stream-eu-a.rcs.revma.com/ywpe7mqb54uvv/6_glpo8niyqr7e02/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-wind' },
      { name: 'MyFriends FM', url: 'https://cast3.asurahosting.com/proxy/myfriend/stream', type: 'mp3', category: 'Hiburan', icon: 'fas fa-user-friends' },
      { name: 'RADIOROSAK', url: 'https://radiorosak.radioca.st/stream', type: 'mp3', category: 'Hiburan', icon: 'fas fa-tools' },
      { name: 'Jazz FM', url: 'https://stream-eu-a.rcs.revma.com/c718dfvbv4uvv/54_7d1x7i1isy7w02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-music' },
      { name: 'Jazz Lounge FM', url: 'https://eu8.fastcast4u.com/proxy/lch?mp=/1', type: 'mp3', category: 'Muzik', icon: 'fas fa-couch' },
      { name: 'Opus FM', url: 'https://stream-eu-a.rcs.revma.com/aqvp4yvbv4uvv/51_xbchzd3wxcmv02/playlist.m3u8', type: 'm3u8', category: 'Muzik', icon: 'fas fa-compact-disc' },
      { name: 'Pilihan FM', url: 'https://d2kziuzkf9oizb.cloudfront.net/rd003/playlist.m3u8', type: 'm3u8', category: 'Hiburan', icon: 'fas fa-star' },
      { name: 'MyKampus FM', url: 'https://usa10.fastcast4u.com/voicespl', type: 'mp3', category: 'Hiburan', icon: 'fas fa-graduation-cap' }
    ];

    // Inisialisasi elemen
    const audioPlayer = document.getElementById('audioPlayer');
    const playBtn = document.getElementById('playBtn');
    const playIcon = document.getElementById('playIcon');
    const btnText = document.getElementById('btnText');
    const currentStation = document.getElementById('currentStation');
    const stationName = document.getElementById('stationName');
    const stationInfo = document.getElementById('stationInfo');
    const volumeSlider = document.getElementById('volumeSlider');
    const volumeIcon = document.getElementById('volumeIcon');
    const searchInput = document.getElementById('searchInput');
    const stationsGrid = document.getElementById('stationsGrid');
    const loading = document.getElementById('loading');
    const errorMessage = document.getElementById('errorMessage');
    const visualizer = document.getElementById('visualizer');
    const sleepTimerBtn = document.getElementById('sleepTimerBtn');
    const sleepTimerDropdown = document.getElementById('sleepTimerDropdown');
    const sleepTimerText = document.getElementById('sleepTimerText');
    const timerDisplay = document.getElementById('timerDisplay');
    const favoritesBtn = document.getElementById('favoritesBtn');
    const favoritesText = document.getElementById('favoritesText');
    const allStationsTab = document.getElementById('allStationsTab');
    const favoritesTab = document.getElementById('favoritesTab');
    const popularTab = document.getElementById('popularTab');
    const tabSlider = document.getElementById('tabSlider');
    const songTitle = document.getElementById('songTitle');
    const progressFill = document.getElementById('progressFill');
    const progressTime = document.getElementById('progressTime');
    const waveformCanvas = document.getElementById('waveformBg');
    
    // Elemen untuk custom timer
    const customMinutesInput = document.getElementById('customMinutes');
    const increaseMinutesBtn = document.getElementById('increaseMinutes');
    const decreaseMinutesBtn = document.getElementById('decreaseMinutes');
    const setCustomTimerBtn = document.getElementById('setCustomTimer');

    let currentStationData = null;
    let hls = null;
    let favorites = new Set();
    let sleepTimer = null;
    let remainingTime = 0;
    let activeTab = 'all';
    let isDropdownAnimating = false;
    let waveformCtx = null;
    let animationFrameId = null;

    // Fungsi utama
    function init() {
      loadFavorites();
      renderStations(stations);
      audioPlayer.volume = volumeSlider.value;
      updateVolumeIcon(volumeSlider.value);
      
      // Setup waveform background
      setupWaveformBackground();
      
      // Setup visualizer
      createAdvancedVisualizer();
      
      // Setup tab slider position
      updateTabSlider();
      
      // Event listeners
      playBtn.addEventListener('click', togglePlay);
      volumeSlider.addEventListener('input', handleVolumeChange);
      searchInput.addEventListener('input', debounce(handleSearch, 300));
      audioPlayer.addEventListener('ended', () => updatePlayState(false));
      audioPlayer.addEventListener('error', handleError);
      audioPlayer.addEventListener('play', () => updatePlayState(true));
      audioPlayer.addEventListener('pause', () => updatePlayState(false));
      
      // Tab listeners
      allStationsTab.addEventListener('click', () => switchTab('all'));
      favoritesTab.addEventListener('click', () => switchTab('favorites'));
      popularTab.addEventListener('click', () => switchTab('popular'));
      
      // Sleep timer listeners
      sleepTimerBtn.addEventListener('click', toggleSleepTimerDropdown);
      document.querySelectorAll('.timer-option').forEach(option => {
        if (option.id !== 'cancelTimer' && !option.classList.contains('custom-timer-input')) {
          option.addEventListener('click', () => {
            setSleepTimer(parseInt(option.dataset.minutes));
            closeSleepTimerDropdown();
          });
        }
      });
      document.getElementById('cancelTimer').addEventListener('click', () => {
        cancelSleepTimer();
        closeSleepTimerDropdown();
      });
      
      // Custom timer controls
      increaseMinutesBtn.addEventListener('click', () => {
        let currentValue = parseInt(customMinutesInput.value) || 30;
        if (currentValue < 300) customMinutesInput.value = currentValue + 1;
      });
      
      decreaseMinutesBtn.addEventListener('click', () => {
        let currentValue = parseInt(customMinutesInput.value) || 30;
        if (currentValue > 1) customMinutesInput.value = currentValue - 1;
      });
      
      setCustomTimerBtn.addEventListener('click', () => {
        let minutes = parseInt(customMinutesInput.value) || 30;
        if (minutes < 1) minutes = 1;
        if (minutes > 300) minutes = 300;
        setSleepTimer(minutes);
        closeSleepTimerDropdown();
      });
      
      customMinutesInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          setCustomTimerBtn.click();
        }
      });
      
      customMinutesInput.addEventListener('change', () => {
        let value = parseInt(customMinutesInput.value);
        if (isNaN(value) || value < 1) customMinutesInput.value = 1;
        if (value > 300) customMinutesInput.value = 300;
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!sleepTimerBtn.contains(e.target) && !sleepTimerDropdown.contains(e.target)) {
          closeSleepTimerDropdown();
        }
      });
      
      // Favorites button listener
      favoritesBtn.addEventListener('click', toggleFavoritesView);
      
      // Focus search input when clicking search icon
      document.querySelector('.search-icon').addEventListener('click', () => {
        searchInput.focus();
      });
      
      // Clear search when clicking Escape
      searchInput.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          searchInput.value = '';
          handleSearch(e);
        }
      });
      
      // Update progress bar animation
      setInterval(updateProgressAnimation, 1000);
    }

    // Setup waveform background
    function setupWaveformBackground() {
      if (!waveformCanvas) return;
      
      waveformCtx = waveformCanvas.getContext('2d');
      resizeWaveformCanvas();
      
      // Start animation
      drawWaveform();
      
      // Resize canvas on window resize
      window.addEventListener('resize', resizeWaveformCanvas);
    }

    function resizeWaveformCanvas() {
      if (!waveformCanvas) return;
      
      waveformCanvas.width = window.innerWidth;
      waveformCanvas.height = window.innerHeight;
    }

    function drawWaveform() {
      if (!waveformCtx) return;
      
      // Clear canvas
      waveformCtx.clearRect(0, 0, waveformCanvas.width, waveformCanvas.height);
      
      // Draw multiple wave lines
      for (let i = 0; i < 3; i++) {
        const amplitude = 15 + i * 10;
        const frequency = 0.01 + i * 0.005;
        const speed = 0.02 + i * 0.01;
        const opacity = 0.05 + i * 0.05;
        
        waveformCtx.beginPath();
        waveformCtx.strokeStyle = `rgba(255, 255, 255, ${opacity})`;
        waveformCtx.lineWidth = 1;
        
        for (let x = 0; x < waveformCanvas.width; x++) {
          const y = waveformCanvas.height / 2 + 
            Math.sin(x * frequency + Date.now() * speed) * amplitude +
            Math.sin(x * frequency * 0.5 + Date.now() * speed * 0.7) * amplitude * 0.5;
          
          if (x === 0) {
            waveformCtx.moveTo(x, y);
          } else {
            waveformCtx.lineTo(x, y);
          }
        }
        
        waveformCtx.stroke();
      }
      
      animationFrameId = requestAnimationFrame(drawWaveform);
    }

    // Create advanced visualizer
    function createAdvancedVisualizer() {
      visualizer.innerHTML = '';
      
      for (let i = 0; i < 32; i++) {
        const bar = document.createElement('div');
        bar.className = 'advanced-bar';
        bar.style.animationDelay = `${i * 0.05}s`;
        visualizer.appendChild(bar);
      }
    }

    function animateVisualizer() {
      const bars = document.querySelectorAll('.advanced-bar');
      
      function updateBars() {
        bars.forEach((bar, index) => {
          const height = 5 + Math.random() * 20;
          const delay = index * 0.05;
          
          bar.style.height = `${height}px`;
          bar.style.animationDelay = `${delay}s`;
        });
        
        if (!audioPlayer.paused) {
          requestAnimationFrame(updateBars);
        }
      }
      
      if (!audioPlayer.paused) {
        updateBars();
      }
    }

    // Debounce function for search
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Load favorites from localStorage
    function loadFavorites() {
      const savedFavorites = localStorage.getItem('radioFavorites');
      if (savedFavorites) {
        favorites = new Set(JSON.parse(savedFavorites));
      }
    }

    // Save favorites to localStorage
    function saveFavorites() {
      localStorage.setItem('radioFavorites', JSON.stringify([...favorites]));
    }

    // Toggle favorite status for a station
    function toggleFavorite(stationName) {
      if (favorites.has(stationName)) {
        favorites.delete(stationName);
        showNotification(`Dialih keluar dari kegemaran`, 'info');
      } else {
        favorites.add(stationName);
        showNotification(`Ditambah ke kegemaran`, 'success');
      }
      saveFavorites();
      renderStations(getFilteredStations());
    }

    // Get favorite stations from the main list
    function getFavoriteStations() {
      return stations.filter(station => favorites.has(station.name));
    }

    // Get popular stations (stations with favorites)
    function getPopularStations() {
      return stations.filter(station => favorites.has(station.name));
    }

    // Get filtered stations based on active tab
    function getFilteredStations() {
      switch (activeTab) {
        case 'favorites':
          return getFavoriteStations();
        case 'popular':
          return getPopularStations();
        default:
          return stations;
      }
    }

    // Render daftar stasiun
    function renderStations(stationList) {
      stationsGrid.innerHTML = stationList.map(station => `
        <div class="station-card" data-name="${station.name}" data-category="${station.category}">
          <span class="category-badge">${station.category}</span>
          <button class="favorite-btn ${favorites.has(station.name) ? 'active' : ''}" data-name="${station.name}">
            <i class="fas fa-heart"></i>
          </button>
          <div class="station-icon">
            <i class="${station.icon}"></i>
          </div>
          <div class="station-name">${station.name}</div>
        </div>
      `).join('');
      
      // Add event listeners to station cards
      document.querySelectorAll('.station-card').forEach(card => {
        card.addEventListener('click', (e) => {
          if (!e.target.closest('.favorite-btn')) {
            playStation(stations.find(s => s.name === card.dataset.name));
          }
        });
      });
      
      // Add event listeners to favorite buttons
      document.querySelectorAll('.favorite-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const stationName = btn.dataset.name;
          toggleFavorite(stationName);
          btn.classList.toggle('active');
        });
      });
    }

    // Update tab slider position
    function updateTabSlider() {
      const tabs = document.querySelectorAll('.tab');
      const activeIndex = Array.from(tabs).findIndex(tab => tab.classList.contains('active'));
      const tabWidth = 100 / tabs.length;
      
      tabSlider.style.width = `${tabWidth}%`;
      tabSlider.style.transform = `translateX(${activeIndex * 100}%)`;
    }

    // Switch between tabs
    function switchTab(tab) {
      activeTab = tab;
      
      // Update active tab classes
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      
      switch (tab) {
        case 'all':
          allStationsTab.classList.add('active');
          break;
        case 'favorites':
          favoritesTab.classList.add('active');
          break;
        case 'popular':
          popularTab.classList.add('active');
          break;
      }
      
      updateTabSlider();
      renderStations(getFilteredStations());
      searchInput.value = ''; // Clear search when switching tabs
    }

    // Toggle favorites view
    function toggleFavoritesView() {
      if (activeTab === 'favorites') {
        switchTab('all');
        favoritesText.textContent = 'Kegemaran';
        favoritesBtn.classList.remove('active');
      } else {
        switchTab('favorites');
        favoritesText.textContent = 'Semua Stesen';
        favoritesBtn.classList.add('active');
      }
    }

    // Memutar stasiun radio
    function playStation(station) {
      if (!station) return;
      
      document.querySelectorAll('.station-card').forEach(card => card.classList.remove('active'));
      const card = document.querySelector(`.station-card[data-name="${station.name}"]`);
      if (card) card.classList.add('active');
      
      currentStationData = station;
      stationName.textContent = station.name;
      stationInfo.textContent = `${station.category} ‚Ä¢ Sedang Dimainkan`;
      currentStation.classList.add('playing');
      
      // Update song title with a rotating text effect
      const titles = [
        `üéµ ${station.name} - Radio Malaysia`,
        `üìª ${station.name} - Strim Langsung`,
        `üåü ${station.name} - Hiburan Terbaik`
      ];
      let titleIndex = 0;
      
      songTitle.textContent = titles[titleIndex];
      setInterval(() => {
        titleIndex = (titleIndex + 1) % titles.length;
        songTitle.textContent = titles[titleIndex];
      }, 5000);
      
      loading.style.display = 'block';
      errorMessage.style.display = 'none';
      
      // Hentikan pemutaran saat ini
      audioPlayer.pause();
      if (hls) hls.destroy();
      
      // Putar stasiun baru
      if (station.type === 'm3u8' && Hls.isSupported()) {
        hls = new Hls();
        hls.loadSource(station.url);
        hls.attachMedia(audioPlayer);
        
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          audioPlayer.play()
            .then(() => {
              loading.style.display = 'none';
              updatePlayState(true);
              showNotification(`üéß Memainkan: ${station.name}`, 'success');
              animateVisualizer();
            })
            .catch(handleError);
        });
        
        hls.on(Hls.Events.ERROR, (_, data) => {
          showError(`Gagal memuat ${station.name}: ${data.details || 'Ralat tidak diketahui'}`);
        });
      } else {
        audioPlayer.src = station.url;
        audioPlayer.play()
          .then(() => {
            loading.style.display = 'none';
            updatePlayState(true);
            showNotification(`üéß Memainkan: ${station.name}`, 'success');
            animateVisualizer();
          })
          .catch(handleError);
      }
    }

    // Toggle play/pause
    function togglePlay() {
      if (audioPlayer.paused) {
        if (currentStationData) {
          audioPlayer.play().then(() => {
            updatePlayState(true);
            showNotification('‚ñ∂Ô∏è Radio dimainkan', 'success');
            animateVisualizer();
          }).catch(handleError);
        } else {
          showError('Sila pilih stesen radio terlebih dahulu.');
        }
      } else {
        audioPlayer.pause();
        updatePlayState(false);
        showNotification('‚è∏Ô∏è Radio dijeda', 'info');
      }
    }

    // Update UI pemutaran
    function updatePlayState(isPlaying) {
      if (isPlaying) {
        playIcon.innerHTML = '<i class="fas fa-pause"></i>';
        btnText.textContent = 'Jeda';
        visualizer.style.display = 'flex';
        playBtn.classList.add('playing');
      } else {
        playIcon.innerHTML = '<i class="fas fa-play"></i>';
        btnText.textContent = 'Main';
        visualizer.style.display = 'none';
        playBtn.classList.remove('playing');
      }
      loading.style.display = 'none';
    }

    // Update volume icon and slider
    function handleVolumeChange(e) {
      const volume = e.target.value;
      audioPlayer.volume = volume;
      updateVolumeIcon(volume);
      
      // Update slider background
      const percentage = volume * 100;
      e.target.style.background = `linear-gradient(to right, var(--primary) ${percentage}%, var(--card-border) ${percentage}%)`;
    }

    function updateVolumeIcon(volume) {
      if (volume === 0) {
        volumeIcon.className = 'fas fa-volume-mute';
      } else if (volume < 0.3) {
        volumeIcon.className = 'fas fa-volume-off';
      } else if (volume < 0.7) {
        volumeIcon.className = 'fas fa-volume-down';
      } else {
        volumeIcon.className = 'fas fa-volume-up';
      }
    }

    // Update progress bar animation
    function updateProgressAnimation() {
      if (audioPlayer.duration && !isNaN(audioPlayer.duration)) {
        const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        progressFill.style.width = `${percentage}%`;
        
        const currentTime = formatTime(audioPlayer.currentTime);
        const duration = formatTime(audioPlayer.duration);
        progressTime.textContent = `${currentTime} / ${duration}`;
      } else {
        // Live stream - show moving progress
        progressFill.style.width = '30%';
        progressFill.style.animation = 'progressPulse 2s infinite';
      }
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    // Sleep timer functions
    function toggleSleepTimerDropdown() {
      if (isDropdownAnimating) return;
      
      if (sleepTimerDropdown.classList.contains('active')) {
        closeSleepTimerDropdown();
      } else {
        openSleepTimerDropdown();
      }
    }

    function openSleepTimerDropdown() {
      if (isDropdownAnimating) return;
      
      isDropdownAnimating = true;
      sleepTimerDropdown.style.display = 'block';
      
      // Force reflow untuk trigger animation
      sleepTimerDropdown.offsetHeight;
      
      sleepTimerDropdown.classList.add('active');
      
      setTimeout(() => {
        isDropdownAnimating = false;
      }, 300);
    }

    function closeSleepTimerDropdown() {
      if (isDropdownAnimating) return;
      
      isDropdownAnimating = true;
      sleepTimerDropdown.classList.remove('active');
      
      setTimeout(() => {
        sleepTimerDropdown.style.display = 'none';
        isDropdownAnimating = false;
      }, 300);
    }

    function setSleepTimer(minutes) {
      cancelSleepTimer(); // Cancel any existing timer
      
      remainingTime = minutes * 60; // Convert to seconds
      sleepTimerText.textContent = `${minutes} Minit`;
      sleepTimerBtn.parentElement.classList.add('active');
      timerDisplay.classList.add('active');
      
      updateTimerDisplay();
      
      sleepTimer = setInterval(() => {
        remainingTime--;
        updateTimerDisplay();
        
        if (remainingTime <= 0) {
          cancelSleepTimer();
          audioPlayer.pause();
          updatePlayState(false);
          showNotification('‚è∞ Pemasa tidur tamat. Radio telah dihentikan.', 'info');
        }
      }, 1000);
      
      showNotification(`‚è∞ Pemasa tidur ditetapkan: ${minutes} minit`, 'success');
    }

    function cancelSleepTimer() {
      if (sleepTimer) {
        clearInterval(sleepTimer);
        sleepTimer = null;
      }
      sleepTimerText.textContent = 'Pemasa Tidur';
      sleepTimerBtn.parentElement.classList.remove('active');
      timerDisplay.classList.remove('active');
      showNotification('‚è∞ Pemasa tidur dibatalkan', 'info');
    }

    function updateTimerDisplay() {
      if (remainingTime > 0) {
        const minutes = Math.floor(remainingTime / 60);
        const seconds = remainingTime % 60;
        
        // Update background color based on remaining time
        let bgColor = 'var(--timer-active)';
        if (remainingTime < 300) { // Less than 5 minutes
          bgColor = 'var(--timer-warning)';
        }
        if (remainingTime < 60) { // Less than 1 minute
          bgColor = 'var(--timer-danger)';
        }
        
        timerDisplay.textContent = `‚è∞ ${minutes}:${seconds.toString().padStart(2, '0')}`;
        timerDisplay.style.background = `linear-gradient(90deg, ${bgColor}, var(--card-bg))`;
        timerDisplay.style.borderColor = bgColor;
      }
    }

    // Pencarian
    function handleSearch(e) {
      const term = e.target.value.toLowerCase();
      const stationList = getFilteredStations();
      const filtered = stationList.filter(s => 
        s.name.toLowerCase().includes(term) || 
        s.category.toLowerCase().includes(term)
      );
      
      if (filtered.length === 0 && term) {
        stationsGrid.innerHTML = `
          <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--secondary);">
            <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
            <h3>Tiada stesen ditemui</h3>
            <p>Cuba kata kunci yang berbeza</p>
          </div>
        `;
      } else {
        renderStations(filtered);
      }
    }

    // Penanganan error
    function handleError(error) {
      console.error('Error:', error);
      showError('Ralat main balik. Sila cuba stesen lain atau muat semula halaman.');
      updatePlayState(false);
    }

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.display = 'block';
      loading.style.display = 'none';
    }

    function showNotification(message, type = 'info') {
      // Remove existing notifications
      document.querySelectorAll('.notification').forEach(el => {
        el.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
          if (el.parentNode) {
            document.body.removeChild(el);
          }
        }, 300);
      });
      
      // Create notification element
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      
      // Choose icon based on type
      let icon = 'fas fa-info-circle';
      if (type === 'success') icon = 'fas fa-check-circle';
      if (type === 'error') icon = 'fas fa-exclamation-circle';
      
      notification.innerHTML = `
        <i class="${icon}"></i>
        <span>${message}</span>
      `;
      
      document.body.appendChild(notification);
      
      // Remove notification after 3 seconds
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
          if (notification.parentNode) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Clean up on page unload
    window.addEventListener('beforeunload', () => {
      if (animationFrameId) {
        cancelAnimationFrame(animationFrameId);
      }
      if (sleepTimer) {
        clearInterval(sleepTimer);
      }
    });

    // Jalankan aplikasi
    init();
  </script>
</body>
</html>
